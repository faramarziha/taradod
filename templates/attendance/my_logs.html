{% extends "core/base.html" %}
{% load jformat %}
{% block title %}گزارش تردد من{% endblock %}
{% block content %}
<div class="card page page-md slide-in">
  <h2 class="page-title"><i class="fa fa-list-alt"></i> گزارش ترددهای {{ user.get_full_name }}</h2>
  <div class="profile-details" style="margin-top:0;">کد پرسنلی: {{ user.personnel_code }}</div>
  <div class="profile-actions" style="margin-bottom:1rem;">
    <a class="btn" href="?month={{ prev_month }}"><i class="fas fa-chevron-right"></i> ماه قبل</a>
    <span style="margin:0 1rem;">{{ jyear }}/{{ jmonth }}</span>
    <a class="btn" href="?month={{ next_month }}">ماه بعد <i class="fas fa-chevron-left"></i></a>
  </div>
  <div class="card table-responsive">
    <table class="management-table">
      <thead>
        <tr><th>تاریخ</th><th>ورود</th><th>خروج</th></tr>
      </thead>
      <tbody>
        {% for day, info in daily_logs.items %}
        <tr style="--i:{{ forloop.counter }}">
          <td>{{ jyear }}/{{ jmonth|stringformat:"02d" }}/{{ day|stringformat:"02d" }}</td>
          <td>{% if info.in %}{{ info.in|time:"H:i" }}{% else %}-{% endif %}</td>
          <td>{% if info.out %}{{ info.out|time:"H:i" }}{% else %}-{% endif %}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="profile-actions">
    <a class="btn" href="{% url 'export_my_logs_csv' %}"><i class="fa fa-download"></i> دریافت CSV</a>
    <a class="btn" href="{% url 'edit_request' %}"><i class="fa fa-edit"></i> درخواست ویرایش</a>
    <a class="btn" href="{% url 'user_edit_requests' %}"><i class="fa fa-list"></i> درخواست‌های ویرایش</a>
    <a class="btn" href="{% url 'user_inquiry' %}"><i class="fas fa-chevron-right"></i> بازگشت</a>
  </div>
</div>
{% endblock %}
