{% extends "core/base.html" %}
{% load static %}
{% block title %}پروفایل کاربر{% endblock %}
{% block content %}
<div class="page page-md fade-in">
  <div class="card profile-card">
    <div class="profile-banner">
      <img class="profile-avatar" src="{% if user.face_image %}{{ user.face_image.url }}{% else %}{% static 'core/avatar.png' %}{% endif %}" alt="{{ user.get_full_name }}">
      <h2 class="page-title"><i class="fa fa-user"></i> {{ user.get_full_name }}</h2>
      <div class="profile-meta">
        <span>کد پرسنلی: {{ user.personnel_code }}</span>
        <span>کد ملی: {{ user.national_id }}</span>
      </div>
    </div>
  </div>

  <div class="card status-widget">
    <h3>وضعیت امروز شما</h3>
    <div>
      <span class="badge {{ status_badge }}">{{ status_label }}</span>
      {% if status_time %}<span class="status-time">اولین ورود: {{ status_time|time:"H:i" }}</span>{% endif %}
    </div>
  </div>

  <div class="card notifications-widget">
    <h3>آخرین اعلان‌ها و درخواست‌ها</h3>
    <ul>
      {% for note in notifications %}
        <li>{{ note }}</li>
      {% empty %}
        <li>اعلان جدیدی نیست.</li>
      {% endfor %}
    </ul>
  </div>

  <div class="card stats-widget">
    <h3>آمار عملکرد من در این ماه</h3>
    <div class="stats-grid">
      <div class="stat-card">
        <span class="stat-value">{{ total_hours }}</span>
        <span class="stat-label">مجموع ساعات کاری ثبت شده</span>
      </div>
      <div class="stat-card">
        <span class="stat-value">{{ tardy_minutes }}</span>
        <span class="stat-label">مجموع دقایق تأخیر</span>
      </div>
      <div class="stat-card">
        <span class="stat-value">{{ absent_days }}</span>
        <span class="stat-label">تعداد روزهای غیبت</span>
      </div>
      <div class="stat-card">
        <span class="stat-value">{% if remaining_leave is not None %}{{ remaining_leave }}{% else %}—{% endif %}</span>
        <span class="stat-label">باقیمانده مرخصی استحقاقی</span>
      </div>
    </div>
  </div>

  <div class="card quick-actions">
    <h3>دسترسی سریع</h3>
    <div class="actions">
      <a class="btn" href="{% url 'my_logs' %}"><i class="fa fa-list-alt" style="margin-left:0.4rem;"></i> مشاهده گزارش کامل تردد</a>
      <a class="btn" href="{% url 'leave_request' %}"><i class="fa fa-plus-circle" style="margin-left:0.4rem;"></i> ثبت درخواست جدید (مرخصی/ویرایش)</a>
      <a class="btn" href="{% url 'user_requests' %}"><i class="fa fa-tasks" style="margin-left:0.4rem;"></i> پیگیری درخواست‌های من</a>
    </div>
  </div>

  <div class="back-action" style="text-align:center; margin-top:1rem;">
    <a class="btn" href="{% url 'user_inquiry' %}"><i class="fas fa-chevron-right" style="margin-left:0.4rem;"></i> بازگشت به صفحه استعلام</a>
  </div>
</div>
{% endblock %}
