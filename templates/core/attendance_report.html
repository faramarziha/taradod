{% extends "core/base_management.html" %}
{% load jformat %}
{% block title %}گزارش پیشرفته{% endblock %}
{% block management_content %}
<h2 class="page-title">
  <i class="fas fa-file-excel" style="margin-left:0.5rem;"></i>
  گزارش پیشرفته
</h2>
<form method="get" class="card page page-sm form-grid" style="margin-bottom:1rem;">
  {{ form.as_p }}
  <div class="profile-actions">
    <button class="btn" type="submit">نمایش</button>
    <button class="btn" type="submit" name="export" value="1">دریافت CSV</button>
  </div>
</form>
{% if report %}
<div class="table-responsive" style="margin-top:1rem;">
  <table class="management-table">
    <thead>
      <tr><th>کاربر</th><th>تاریخ</th><th>ساعت</th><th>نوع</th></tr>
    </thead>
    <tbody>
      {% for row in report %}
      <tr>
        <td>{{ row.user }}</td>
        <td>{{ row.time|jformat:"%Y/%m/%d" }}</td>
        <td>{{ row.time|time:"H:i" }}</td>
        <td>{% if row.type == 'in' %}ورود{% else %}خروج{% endif %}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}
{% endblock %}
