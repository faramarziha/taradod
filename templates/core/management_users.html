{% extends "core/base_management.html" %}
{% block title %}مدیریت کاربران{% endblock %}
{% block management_content %}
<h2 class="page-title">
  <i class="fas fa-users-cog"></i>
  مدیریت کاربران
</h2>
<a class="btn" href="{% url 'user_add' %}" style="margin-bottom:1.4rem;">
  <i class="fas fa-user-plus" style="margin-left:0.5rem;"></i> افزودن کاربر جدید
</a>
<div class="table-responsive">
<table class="management-table stacked-table">
  <thead>
    <tr>
      <th>ردیف</th>
      <th>کد پرسنلی</th>
      <th>نام و نام خانوادگی</th>
      <th>وضعیت</th>
      <th>ثبت چهره</th>
      <th>عملیات</th>
    </tr>
  </thead>
  <tbody>
    {% for user in users %}
      <tr>
        <td data-label="ردیف">{{ forloop.counter }}</td>
        <td data-label="کد پرسنلی">{{ user.personnel_code }}</td>
        <td data-label="نام و نام خانوادگی">{{ user.get_full_name }}</td>
        <td data-label="وضعیت">
          {% if user.is_active %}
            <span class="badge badge-approved">فعال</span>
          {% else %}
            <span class="badge badge-rejected">غیرفعال</span>
          {% endif %}
        </td>
        <td data-label="ثبت چهره">
          {% if user.face_encoding %}
            <i class="fa fa-check-circle" style="color: var(--color-secondary);"></i>
          {% else %}
            <i class="fa fa-times-circle" style="color: var(--color-error);"></i>
          {% endif %}
        </td>
        <td data-label="عملیات">
          <a href="{% url 'user_update' user.pk %}" title="ویرایش"><i class="fas fa-edit"></i></a>
          <a href="{% url 'register_face_page_for_user' user.pk %}" title="ثبت چهره"><i class="fas fa-camera"></i></a>
          <a href="{% url 'user_logs_admin' user.pk %}" title="ترددها"><i class="fas fa-list"></i></a>
          <a href="{% url 'user_delete' user.pk %}" title="حذف"><i class="fas fa-trash-alt"></i></a>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="6">هیچ کاربری یافت نشد</td></tr>
    {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}
